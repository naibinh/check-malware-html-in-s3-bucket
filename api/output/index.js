const _ = require('lodash');

const output = (results) => {

    const matches = results
        .map(result => result.data.matches)
        .filter(matches => !_.isEmpty(matches))
        .reduce((result, matches) => {
            return result.concat(matches);
        }, []) // flatten array
        .map(match => ({
            threatType: match.threatType,
            threatUrl: match.threat.url
        }));

    if (_.isEmpty(matches)) {
        console.log('All HTML files in bucket are OK');
    } else {
        matches.forEach(match => console.log(`DETECTED ${match.threatType} SITE: ${match.threatUrl}`));
    }
};

module.exports = output;